// SPDX-FileCopyrightText: Copyright (c) 2026 The Excalibur Project
// SPDX-License-Identifier: LicenseRef-Excalibur-1.0 OR AGPL-3.0-or-later OR SSPL-1.0 OR Apache-2.0


namespace Excalibur.Data.ElasticSearch.Security;

/// <summary>
/// Represents a security alert generated by the monitoring system.
/// </summary>
public sealed class SecurityAlert
{
	/// <summary>
	/// Initializes a new instance of the <see cref="SecurityAlert" /> class.
	/// </summary>
	public SecurityAlert()
	{
	}

	/// <summary>
	/// Initializes a new instance of the <see cref="SecurityAlert" /> class.
	/// </summary>
	/// <param name="alertId"> The unique identifier for this security alert. </param>
	/// <param name="alertType"> The type of security alert. </param>
	/// <param name="severity"> The severity level of the alert. </param>
	/// <param name="title"> The title or summary of the alert. </param>
	/// <param name="description"> The detailed description of the alert. </param>
	/// <param name="detectedAt"> The timestamp when the alert was detected. </param>
	public SecurityAlert(
		Guid alertId,
		string alertType,
		SecurityEventSeverity severity,
		string title,
		string description,
		DateTimeOffset detectedAt)
	{
		AlertId = alertId;
		AlertType = alertType ?? throw new ArgumentNullException(nameof(alertType));
		Severity = severity;
		Title = title ?? throw new ArgumentNullException(nameof(title));
		Description = description ?? throw new ArgumentNullException(nameof(description));
		DetectedAt = detectedAt;
	}

	/// <summary>
	/// Gets or initializes the unique identifier for this security alert.
	/// </summary>
	/// <value>
	/// The unique identifier for this security alert.
	/// </value>
	public Guid AlertId { get; init; }

	/// <summary>
	/// Gets or initializes the type of security alert.
	/// </summary>
	/// <value>
	/// The type of security alert.
	/// </value>
	public string AlertType { get; init; } = string.Empty;

	/// <summary>
	/// Gets or initializes the severity level of the alert.
	/// </summary>
	/// <value>
	/// The severity level of the alert.
	/// </value>
	public SecurityEventSeverity Severity { get; init; }

	/// <summary>
	/// Gets or initializes the title or summary of the alert.
	/// </summary>
	/// <value>
	/// The title or summary of the alert.
	/// </value>
	public string Title { get; init; } = string.Empty;

	/// <summary>
	/// Gets or initializes the detailed description of the alert.
	/// </summary>
	/// <value>
	/// The detailed description of the alert.
	/// </value>
	public string Description { get; init; } = string.Empty;

	/// <summary>
	/// Gets or initializes the timestamp when the alert was detected.
	/// </summary>
	/// <value>
	/// The timestamp when the alert was detected.
	/// </value>
	public DateTimeOffset DetectedAt { get; init; }

	/// <summary>
	/// Gets or initializes the timestamp when the alert was detected (alias for DetectedAt).
	/// </summary>
	/// <value>
	/// The timestamp when the alert was detected.
	/// </value>
	public DateTimeOffset Timestamp
	{
		get => DetectedAt;
		init => DetectedAt = value;
	}

	/// <summary>
	/// Gets or initializes the source entity or IP address that triggered this alert.
	/// </summary>
	/// <value>
	/// The source entity or IP address that triggered this alert.
	/// </value>
	public string? Source { get; init; }

	/// <summary>
	/// Gets or initializes the user identifier associated with this alert.
	/// </summary>
	/// <value>
	/// The user identifier associated with this alert.
	/// </value>
	public string? UserId { get; init; }

	/// <summary>
	/// Gets or initializes a value indicating whether this alert has been acknowledged.
	/// </summary>
	/// <value>
	/// A value indicating whether this alert has been acknowledged.
	/// </value>
	public bool IsAcknowledged { get; init; }

	/// <summary>
	/// Gets or initializes a value indicating whether this alert has been resolved.
	/// </summary>
	/// <value>
	/// A value indicating whether this alert has been resolved.
	/// </value>
	public bool IsResolved { get; init; }

	/// <summary>
	/// Gets or initializes the timestamp when this alert was acknowledged.
	/// </summary>
	/// <value>
	/// The timestamp when this alert was acknowledged.
	/// </value>
	public DateTimeOffset? AcknowledgedAt { get; init; }

	/// <summary>
	/// Gets or initializes the user who acknowledged this alert.
	/// </summary>
	/// <value>
	/// The user who acknowledged this alert.
	/// </value>
	public string? AcknowledgedBy { get; init; }

	/// <summary>
	/// Gets or initializes the timestamp when this alert was resolved.
	/// </summary>
	/// <value>
	/// The timestamp when this alert was resolved.
	/// </value>
	public DateTimeOffset? ResolvedAt { get; init; }

	/// <summary>
	/// Gets or initializes the user who resolved this alert.
	/// </summary>
	/// <value>
	/// The user who resolved this alert.
	/// </value>
	public string? ResolvedBy { get; init; }

	/// <summary>
	/// Gets or initializes additional contextual information about the alert.
	/// </summary>
	/// <value>
	/// Additional contextual information about the alert.
	/// </value>
	public IReadOnlyDictionary<string, object> Context { get; init; } = new Dictionary<string, object>(StringComparer.Ordinal);

	/// <summary>
	/// Gets or initializes the recommended actions for this alert.
	/// </summary>
	/// <value>
	/// The recommended actions for this alert.
	/// </value>
	public IReadOnlyList<string> RecommendedActions { get; init; } = Array.Empty<string>();

	/// <summary>
	/// Gets or initializes related alert identifiers.
	/// </summary>
	/// <value>
	/// Related alert identifiers.
	/// </value>
	public IReadOnlyList<string> RelatedAlerts { get; init; } = Array.Empty<string>();
}
