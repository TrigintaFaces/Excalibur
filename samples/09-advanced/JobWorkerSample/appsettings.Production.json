{
  "Logging": {
	"LogLevel": {
	  "Default": "Information",
	  "Microsoft.Hosting.Lifetime": "Information",
	  "Quartz": "Information",
	  "Excalibur.Jobs": "Debug"
	}
  },
  "Serilog": {
	"MinimumLevel": {
	  "Default": "Information",
	  "Override": {
		"Microsoft": "Warning",
		"System": "Warning",
		"Quartz": "Information",
		"Excalibur": "Debug"
	  }
	},
	"WriteTo": [
	  {
		"Name": "Console",
		"Args": {
		  "theme": "Serilog.Sinks.SystemConsole.Themes.AnsiConsoleTheme::Code, Serilog.Sinks.Console",
		  "outputTemplate": "[{Timestamp:HH:mm:ss} {Level:u3}] {SourceContext}: {Message:lj}{NewLine}{Exception}"
		}
	  },
	  {
		"Name": "File",
		"Args": {
		  "path": "logs/jobs-.txt",
		  "rollingInterval": "Day",
		  "retainedFileCountLimit": 7,
		  "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {SourceContext}: {Message:lj}{NewLine}{Exception}"
		}
	  }
	],
	"Enrich": [ "FromLogContext", "WithMachineName", "WithThreadId" ]
  },
  "ConnectionStrings": {
	"JobStore": "Server=localhost;Database=ExcaliburJobs;Integrated Security=true;TrustServerCertificate=true;",
	"ApplicationDb": "Server=localhost;Database=ExcaliburApp;Integrated Security=true;TrustServerCertificate=true;",
	"StateDb": "Server=localhost;Database=ExcaliburState;Integrated Security=true;TrustServerCertificate=true;"
  },
  "Jobs": {
	"RunMigrations": true,
	"DefaultTimeZone": "UTC",
	"CdcJob": {
	  "JobName": "CDC Processor",
	  "JobGroup": "DataSync",
	  "CronSchedule": "0/30 * * * * ?",
	  "DegradedThreshold": "00:05:00",
	  "UnhealthyThreshold": "00:15:00",
	  "Disabled": false,
	  "DatabaseConfigs": [
		{
		  "DatabaseName": "ExcaliburApp",
		  "DatabaseConnectionIdentifier": "ApplicationDb",
		  "StateConnectionIdentifier": "StateDb",
		  "StopOnMissingTableHandler": true,
		  "CaptureInstances": [
			"dbo_Orders",
			"dbo_Customers",
			"dbo_Products"
		  ],
		  "BatchTimeInterval": 5000,
		  "QueueSize": 1000,
		  "ProducerBatchSize": 100,
		  "ConsumerBatchSize": 10
		}
	  ]
	},
	"OutboxJob": {
	  "JobName": "Outbox Processor",
	  "JobGroup": "Messaging",
	  "CronSchedule": "0/10 * * * * ?",
	  "DegradedThreshold": "00:02:00",
	  "UnhealthyThreshold": "00:05:00",
	  "Disabled": false,
	  "MaxRetryAttempts": 3,
	  "MessageBatchSize": 50,
	  "ProcessingTimeout": "00:01:00",
	  "DeadLetterAfterHours": 24
	},
	"DataProcessingJob": {
	  "JobName": "Data Processor",
	  "JobGroup": "Processing",
	  "CronSchedule": "0 0/5 * * * ?",
	  "DegradedThreshold": "00:10:00",
	  "UnhealthyThreshold": "00:30:00",
	  "Disabled": false,
	  "MaxConcurrentTasks": 5,
	  "TaskBatchSize": 20,
	  "ProcessingTimeout": "00:05:00"
	}
  },
  "Quartz": {
	"quartz.scheduler.instanceName": "ExcaliburJobScheduler",
	"quartz.scheduler.instanceId": "AUTO",
	"quartz.threadPool.type": "Quartz.Simpl.DefaultThreadPool, Quartz",
	"quartz.threadPool.threadCount": "10",
	"quartz.jobStore.misfireThreshold": "60000",
	"quartz.jobStore.type": "Quartz.Impl.AdoJobStore.JobStoreTX, Quartz",
	"quartz.jobStore.useProperties": "true",
	"quartz.jobStore.dataSource": "default",
	"quartz.jobStore.tablePrefix": "QRTZ_",
	"quartz.jobStore.clustered": "true",
	"quartz.jobStore.clusterCheckinInterval": "20000",
	"quartz.dataSource.default.connectionString": "Server=localhost;Database=ExcaliburJobs;Integrated Security=true;TrustServerCertificate=true;",
	"quartz.dataSource.default.provider": "SqlServer",
	"quartz.serializer.type": "json"
  },
  "HealthChecks": {
	"UI": {
	  "HealthChecks": [
		{
		  "Name": "Jobs Health",
		  "Uri": "/health"
		}
	  ],
	  "Webhooks": [],
	  "EvaluationTimeInSeconds": 60,
	  "MinimumSecondsBetweenFailureNotifications": 300
	}
  }
}
